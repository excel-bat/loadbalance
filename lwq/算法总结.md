# 负载均衡算法总结

## 轮询（Round Robin）法

### 思想
轮询很容易实现，将请求按顺序轮流分配到后台服务器上，均衡的对待每一台服务器，而不关心服务器实际的连接数和当前的系统负载。

### 优缺点
轮询法适用于机器性能相同的服务，一旦某台机器性能不好，极有可能产生木桶效应，性能差的机器扛不住更多的流量。


## 随机法

### 思想
随着调用量的增大，其实际效果越来越接近于平均分配流量到后台的每一台服务器，也就是轮询法的效果。 

### 优缺点
同样地，它也不适用于机器性能有差异的分布式系统。


## 随机轮询法

### 思想
只是在选择第一个节点用了随机方法，其他与轮询法无异

### 优缺点
缺点跟轮询一样。


## 平滑加权轮询

### 思想
每个服务器都有两个权重变量。weight，配置文件中指定的该服务器的权重，这个值是固定不变的；current_weight，服务器目前的权重。一开始为 0，之后会动态调整。每次当请求到来，选取服务器时，会遍历数组中所有服务器。对于每个服务器，让它的 current_weight 增加它的 weight；同时累加所有服务器的 weight，并保存为 total。遍历完所有服务器之后，如果该服务器的 current_weight 是最大的，就选择这个服务器处理本次请求。最后把该服务器的 current_weight 减去 total。

### 优缺点
综合考虑了时间相关性的加权轮询。Nginx的负载均衡默认算法是加权轮询算法。
保持选择的平滑性


## 源地址哈希法

### 思想
相同的IP客户端，如果服务器列表不变，将映射到同一个后台服务器进行访问。该方法适合访问缓存系统，如果为了增强缓存的命中率和单调性，可以用一致性哈希算法

### 优缺点
增强缓存的命中率和单调性


## 加权随机（Weight Random）法

### 思想
随机时引入随机

### 优缺点
适用于机器性能有差异的分布式系统。

## 最小连接数法

### 思想
动态的选取其中当前积压连接数最少的一台服务器来处理当前请求

### 优缺点
尽可能的提高后台服务器利用率，将负载合理的分流到每一台服务器。


## Latency-Aware

### 思想
请求服务器的往返延迟（RTT），动态地选择延迟最低的节点处理当前请求。该方法的计算延迟的具体实现可以用EWMA算法来实现，它使用滑动窗口来计算移动平均耗时。

### 优缺点
考虑了服务器当前状态。


## P2C算法

### 思想
首先随机选取两个节点，在这两个节点中选择延迟低，或者连接数小的节点处理请求

### 优缺点
这样兼顾了随机性，又兼顾了机器的性能，实现很简单。 


## Aperture

### 思想
向多个服务器同时发送数据，在返回数据中进行挑选

### 优缺点
适合询问量少服务器多的情况


## 观察算法

### 思想
该算法同时利用最小连接算法和最快算法来实施负载均衡。服务器根据当前的连接数和响应时间得到一个分数，分数较高代表性能较好，会得到更多的连接。

### 优缺点
综合最小连接算法和最快算法


## 预判算法

### 思想
该算法使用观察算法来计算分数，但是预判算法会分析分数的变化趋势来判断某台服务器的性能正在改善还是降低。

### 优缺点
具有改善趋势的服务器会得到更多的连接。该算法适用于大多数环境


## Peak EWMA

### 思想
滑动窗口的一种

### 优缺点

## 

### 思想

### 优缺点

